{% set press_id = module.press_blog_field  %}
{% set press_recent_posts = blog_recent_posts(press_id, 20) %}
{% set press_popular_posts = blog_popular_posts(press_id, 20) %}
{% set path = request.path|split('/', 2)|last %}
{% set pressTotalContents = path == 'presscenter' ? '/presscenter/page/1?type=blog&text=프레스센터' : '' %}

<section class="press-contents-full">
	<!--  최신글  -->
	<div class="conWrap-body conWrap-body-recent">
		<div class="inner2">
      <!---로딩---->
      <div id='loading-container' class='loading-container' style="display:none;justify-content:center;align-items: center;flex-direction: column;">
        <img class='loading-gif' src='https://f.hubspotusercontent40.net/hubfs/20028749/C_NewsRoom_kr/loading-search.gif' alt='loading'>
        <span class='searching'>Searching…</span>
      </div>

      <div class='noSearchContainer'>
        <img class='noSearchImg' style='width: 85.9px;' class='no-search-icon' src='{{get_asset_url('/hynixNewsRoom/codeFiles/images/defaultImage/noun-search-result-1241317o2x.png')}}' alt='noSearch'>
        <span class='noSearchTitle'>검색결과가 없습니다.</span>
        <span class='noSearchDesc'>검색하신 단어가 정확한지 확인해 주시거나 다른 검색어를 사용해 주시기 바랍니다.</span>
        <a class='noSearchBtn'>이전 화면으로</a>
      </div>
      <!---로딩끝--->
      
      
      
			<ul class="list-main-contents recent-blog">
				{% for post in press_recent_posts %}
				<li class="conWrap">
					<div class="col-8">
						<a href="{{post.absolute_url}}">
							<h1>{{post.name}}</h1>
							<div style="display:none" class='removeBody{{loop.index}}'>{{post.post_body}}</div>
							<p class="showBody{{loop.index}}"></p>
						</a>
						<hr>
						<div class="post-meta">
							<span class="date">{{post.publish_date | datetimeformat ('%Y-%m-%d')}}</span>
							<span class="author">
								{% for topic in post.topic_list %}
								{% if topic != '' %}
								<a>#{{topic.name}}</a>
								{% else %}
								{% endif%}
								{% endfor %}
							</span>
						</div>
					</div>
					<div class="col-4">
						<div class="imgWrap">
              <a href="{{post.absolute_url}}"><img src="{{post.featured_image ? post.featured_image : get_asset_url("/hynixNewsRoom/codeFiles/images/contentImage/groupO2x.png")}}" alt="이미지"></a>
						</div>
					</div>
				</li>
				{% endfor %}
				<!-- 글 더보기 -->
				<a id='loady' class="card-more">
					글 더보기
					<i></i>
				</a>
				<a href="{{pressTotalContents}}" style='display:none;' class="card-more recent-blog-btn">
					전체 글 보기
					<i></i>
				</a>
			</ul>
		</div>
	</div>
	<!--  최신글  -->

	<!--   인기글 -->
	<div class="conWrap-body conWrap-body-popularity">
		<div class="inner2">
			<ul class="list-main-contents popular-blog">
				{% for post in press_popular_posts %}
				<li class="conWrap">
					<div class="col-8">
						<a href="{{post.absolute_url}}">
							<h1>{{post.name}}</h1>
							<div class='removeBody{{loop.index}}'>{{post.post_body}}</div>
							<p class="showBody{{loop.index}}"></p>
						</a>
						<hr>
						<div class="post-meta">
							<span class="date">{{post.publish_date | datetimeformat ('%Y-%m-%d')}}</span>

							<span class="author">
								{% for topic in post.topic_list %}
								{% if topic != '' %}
								<a>#{{topic.name}}</a>
								{% else %}
								{% endif%}
								{% endfor %}
							</span>
						</div>
					</div>
					<div class="col-4">
						<div class="imgWrap">
							<a href="#"><img src="{{post.featured_image ? post.featured_image : get_asset_url("/hynixNewsRoom/codeFiles/images/contentImage/img-home-pressThumbO2x.png")}}" alt="이미지"></a>
						</div>
					</div>
				</li>
				{% endfor %}
				<!-- 글 더보기 -->
				<a id="loady2" class="card-more ">
					글 더보기
					<i></i>
				</a>
				<a href="{{pressTotalContents}}" style='display:none;' class="card-more popular-blog-btn">
					전체 글 보기
					<i></i>
				</a>
			</ul>
		</div>
	</div>
	<!--   인기글 -->
</section>


<script type="text/babel">
	$( document ).ready(() => {
  
  $('.noSearchBtn').click(() => {
    console.log('nosearch Click');
    window.history.back();
  })
  
  const ele = $('.list-main-contents').children('li').length;
  
  const getBody = (rem,show) => {
    const press_content = $(rem).text();
    const press = press_content.slice(0,100);
    $(show).html(press);
    $(rem).remove();
  }
  for(let i = 1; i <= ele; i++) {
    getBody(`.removeBody${i}`,`.showBody${i}`);
  }
  
     const $url = window.location.href;
     console.log($url,'2222');
    $('.author').click((e) => {
      console.log($(e.target).text(),'clickclick!!!');
      if($url.includes('presscenter')) {
        console.log('참입니다.255');
        let k = $(e.target).text();
        let tValue = k.slice(1,k.length);
        $('span.author a').attr('href', `/presscenter/tag/${tValue}/page/1?type=tag&text=${tValue}`)
      }
    });
  
})
</script>
